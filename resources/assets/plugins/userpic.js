"use strict";
window.Userpic=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),h=n(a),l=function(){function t(e,i){o(this,t),this.el=e,this.options={width:96,height:96,mode:"letter",shape:{type:"circle"},content:!1,shapeFilters:[],filters:[],fontFamily:"Georgia, Arial, Tahoma"};var n=e.getAttribute("data-userpic-content");n&&(this.options.content=n),Object.assign(this.options,i||{}),"object"!=r(this.options.shape)&&(this.options.shape={type:this.options.shape}),this.options.minDimemsion=Math.min(this.options.width,this.options.height),(this.options.filters.length||this.options.shapeFilters.length)&&(this.filters=new h.default),this.checkOptions(),this.getColor(),this.createCanvasElement(),this.render()}return s(t,[{key:"toDataUrl",value:function(){return this.canvas.toDataURL("image/png")}},{key:"render",value:function(){this.drawShape(),this.applyShapeFilters(),this.drawContent(),this.applyFilters()}},{key:"drawContent",value:function(){this.ctx.fillStyle="#FFFFFF",this[this.options.mode+"ContentDrawer"]()}},{key:"letterContentDrawer",value:function(){var t=.5*this.options.minDimemsion,e=this.options.content[0],i=this.options.width/2,n=this.options.height/2+t/3;this.ctx.font=t+"px "+this.options.fontFamily,this.ctx.textAlign="center",this.ctx.fillText(e,i,n)}},{key:"wordContentDrawer",value:function(t){t=t||this.options.content.split(" ")[0];var e=this.textSizeToFit(t,this.options.fontFamily),i=this.options.width/2,n=this.options.height/2+e/3;this.ctx.font=e+"px "+this.options.fontFamily,this.ctx.textAlign="center",this.ctx.fillText(t,i,n)}},{key:"nameContentDrawer",value:function(){for(var t="",e=this.options.content.split(" "),i=0;i<e.length;i++)t+=e[i][0]+".";this.wordContentDrawer(t)}},{key:"firstLettersContentDrawer",value:function(){for(var t="",e=this.options.content.split(" "),i=0;i<e.length;i++)t+=e[i][0];this.wordContentDrawer(t)}},{key:"textSizeToFit",value:function(t,e){var i=this.getTextSizeThatFit(t,e,0,600,.7*this.options.width);return i}},{key:"getTextSizeThatFit",value:function(t,e,i,n,o){if(n-i<1)return i;var r=i+(n-i)/2;return this.ctx.font=r+"px "+e,this.ctx.measureText(t).width>o?this.getTextSizeThatFit(t,e,i,r,o):this.getTextSizeThatFit(t,e,r,n,o)}},{key:"drawShape",value:function(){this.ctx.fillStyle=this.color,this.ctx.beginPath(),this[this.options.shape.type+"ShapeDrawer"](),this.ctx.closePath()}},{key:"circleShapeDrawer",value:function(){var t=this.options.minDimemsion/2;this.ctx.arc(t,t,t,0,2*Math.PI,!1),this.ctx.fill()}},{key:"squareShapeDrawer",value:function(){this.ctx.fillRect(0,0,this.options.width,this.options.height)}},{key:"polygonShapeDrawer",value:function(){var t=this.options.shape.sides||6,e=this.options.minDimemsion/2,i=this.options.width/2,n=this.options.height/2;this.ctx.moveTo(i+e*Math.cos(0),n+e*Math.sin(0));for(var o=1;o<=t;o+=1)this.ctx.lineTo(i+e*Math.cos(2*o*Math.PI/t),n+e*Math.sin(2*o*Math.PI/t));this.ctx.fill()}},{key:"applyShapeFilters",value:function(){if(this.options.shapeFilters.length)for(var t=0;t<this.options.shapeFilters.length;t++)this.filters.run(this.options.shapeFilters[t],this.ctx,this.options)}},{key:"applyFilters",value:function(){if(this.options.filters.length)for(var t=0;t<this.options.filters.length;t++)this.filters.run(this.options.filters[t],this.ctx,this.options)}},{key:"createCanvasElement",value:function(){this.el.innerHTML='<canvas width="'+this.options.width+'" height="'+this.options.height+'"></canvas>',this.ctx=this.el.querySelector("canvas").getContext("2d"),this.canvas=this.el.childNodes[0]}},{key:"getColor",value:function(){var t=this.hash(this.options.content);this.color=this.intToHEX(t)}},{key:"hash",value:function t(e){for(var t=0,i=0;i<e.length;i++)t=e.charCodeAt(i)+((t<<5)-t);return t}},{key:"intToHEX",value:function(t){var e=(16777215&t).toString(16).toUpperCase();return"#"+"00000".substring(0,6-e.length)+e}},{key:"checkOptions",value:function(){if(this.options.height<10)throw new Error("Are you sure that the userpic is smaller then 10 pixels?");if(this.options.width<10)throw new Error("Are you sure that the userpic is smaller then 10 pixels?");if(!this.options.content)throw new Error("Content attribute is required!");if(!this.options.shape||!this.options.shape.type)throw new Error("Shape option is required!");if(!this.options.mode||!this[this.options.mode+"ContentDrawer"])throw new Error('Mode "'+this.options.mode+'" is wrong!')}}]),t}();Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var i=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(void 0!==o&&null!==o)for(var r=Object.keys(Object(o)),s=0,a=r.length;s<a;s++){var h=r[s],l=Object.getOwnPropertyDescriptor(o,h);void 0!==l&&l.enumerable&&(i[h]=o[h])}}return i}}),t.exports=l},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();t.exports=function(){function t(){i(this,t)}return o(t,[{key:"run",value:function(t,e,i){t="object"==("undefined"==typeof t?"undefined":n(t))?t:{name:t};var o=this[t.name+"Filter"];return o?void o.call(this,e,i,t):void console.error('Filter "'+t.name+'" not found!')}},{key:"grayscaleFilter",value:function(t,e,i){for(var n=t.getImageData(0,0,e.width,e.height),o=n.data,r=0;r<o.length;r+=4){var s=.34*o[r]+.5*o[r+1]+.16*o[r+2];o[r]=s,o[r+1]=s,o[r+2]=s}t.putImageData(n,0,0)}},{key:"noiseFilter",value:function(t,e,i){for(var n=t.getImageData(0,0,e.width,e.height),o=n.data,r=0;r<e.width;r++)for(var s=0;s<e.height;s++){var a=4*r+4*s*e.width,h={a:o[a+3]};if(!(h.a<1)){var l=.2*Math.random();t.fillStyle="rgba(255,255,255,"+l+")",t.fillRect(r,s,1,1)}}}},{key:"vLinesFilter",value:function(t,e,i){this.linesFilter(t,e,i)}},{key:"hLinesFilter",value:function(t,e,i){this.linesFilter(t,e,i,!0)}},{key:"linesFilter",value:function(t,e,i,n){var o={lineSize:5,opacity:.1,rgb:[255,255,255]};Object.assign(o,i);var r=t.getImageData(0,0,e.width,e.height),s=r.data,a=o.opacity,h=0,l=o.rgb.join(",");if(n)for(var c=0;c<e.height;c++){c%o.lineSize==0&&(o.opacity=0==o.opacity?a:0);for(var p=0;p<e.width;p++)h=4*p+4*c*e.width,s[h+3]<1||(t.fillStyle="rgba("+l+","+o.opacity+")",t.fillRect(p,c,1,1))}else for(var c=0;c<e.width;c++){c%o.lineSize==0&&(o.opacity=0==o.opacity?a:0);for(var p=0;p<e.height;p++)h=4*c+4*p*e.width,s[h+3]<1||(t.fillStyle="rgba("+l+","+o.opacity+")",t.fillRect(c,p,1,1))}}}]),t}()}]);